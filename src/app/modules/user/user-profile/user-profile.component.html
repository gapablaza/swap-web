<div *ngIf="!isLoaded" class="loading-indicator">
  <mat-spinner></mat-spinner>
</div>
<section *ngIf="isLoaded" class="user">
  <div class="user-visual">
    <div class="user-imagen-container">
      <img class="user-image" [defaultImage]="defaultUserImage" [lazyLoad]="user.image || defaultUserImage" [alt]="user.displayName">
    </div>
    <div class="user-indicators">
      <span *ngIf="user.accountTypeId == 2" class="pro-label">PRO</span>
      <span *ngIf="(user.positives || 0) > 0" class="positives-label">+{{ user.positives }}</span>
      <span *ngIf="(user.negatives || 0) > 0" class="negatives-label">-{{ user.negatives }}</span>
    </div>
    <a class="btn" mat-raised-button color="accent"><mat-icon inline="true">add</mat-icon> Conversar</a>
  </div>
  <div class="user-info card">
    <h1>{{ user?.displayName }}</h1>
    <h2 *ngIf="user.location">Desde {{ user?.location_city }}, {{ user?.location_country }}</h2>
    <h2 *ngIf="!user.location">Desde <i>Sin información</i></h2>

    <div *ngIf="user.disabled" class="alert">
      <div class="alert-container" style="opacity: 1;">
        <div class="alert-icon">
          <div class="alert-default-icon">
            <mat-icon>error_outline</mat-icon>
          </div>
        </div>
        <div class="alert-content">
          <div class="alert-title">Atención</div>
          <div class="alert-message">Este usuario tiene activado el modo "Incógnito" por lo que no es considerado en los posibles cambios, no puede registrar evaluaciones ni puede enviar/recibir mensajes</div>
        </div>
      </div>
    </div>

    <p>ID de usuario: <strong>{{ user.id }}</strong></p>
    <p>Inició sesión por última vez el <strong>{{ user.lastLogin | date:'dd/MM/YYYY' }}</strong> (hace <strong>{{ user.daysSinceLogin }}</strong> días)</p>
    <p *ngIf="user.bio"  class="user-description" [innerHTML]="user.bio | sanitizeHtml"></p>

    <h3>Acceso a secciones</h3>
    <mat-nav-list>
      <a mat-list-item [routerLink]="['./evaluation']">
        <div mat-line>
          Evaluaciones recibidas&nbsp;
          <span *ngIf="(user.positives || 0) > 0" class="positives-label">+{{ user.positives }}</span>
          <span *ngIf="(user.negatives || 0) > 0" class="negatives-label">-{{ user.negatives }}</span>
        </div>
        <mat-icon>navigate_next</mat-icon>
      </a>
      <a mat-list-item [routerLink]="['./collection']">
        <div mat-line>
          Tiene <strong>{{ user.collections | number:'':'es' }}</strong> colecciones, <strong>{{ user.completedCollections | number:'':'es' }}</strong> completadas
        </div>
        <mat-icon>navigate_next</mat-icon>
      </a>
      <a mat-list-item [routerLink]="['./media']">
        <div mat-line>
          Ha agregado <strong>{{ user.contributions || 0 }}</strong> elemento(s) multimedia
        </div>
        <mat-icon>navigate_next</mat-icon>
      </a>
    </mat-nav-list>

    <hr />

    <div class="user-publisher">
      <p>Busca <strong>{{ user.wishing | number:'':'es' }}</strong> ítems, cambia <strong>{{ user.trading | number:'':'es' }}</strong> ítems</p>
      <p>Cuenta creada el {{ user.registration | date:'dd/MM/YYYY' }}</p>
    </div>
  </div>
</section>
